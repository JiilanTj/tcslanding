---
import ThemeSwitcher from './ThemeSwitcher.astro';

type NavLink = {
  label: string;
  href: string;
};

const navLinks: NavLink[] = [
  { label: 'Home', href: '/' },
  { label: 'Services', href: '/services' },
  { label: 'Work', href: '/work' },
  { label: 'About', href: '/about' },
  { label: 'Pricing', href: '/pricing' },
  { label: 'Blog', href: '/blog' },
];

const desktopLinkBase =
  'relative font-medium transition-all duration-200 hover:scale-105 pb-1 border-b-2 border-transparent focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-4 focus-visible:outline-primary/70';
const desktopLinkActive =
  'text-gray-900 dark:text-text-dark-primary border-primary dark:border-primary font-semibold';
const desktopLinkInactive =
  'text-gray-700 dark:text-text-dark-secondary hover:text-primary dark:hover:text-primary';

const mobileLinkBase =
  'block py-2 px-4 rounded-lg font-medium transition-colors focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-primary/70';
const mobileLinkActive =
  'bg-primary/10 text-text-light-primary dark:text-text-dark-primary border border-primary/30';
const mobileLinkInactive =
  'text-gray-700 dark:text-text-dark-secondary hover:bg-gray-100 dark:hover:bg-surface-dark';

const { pathname } = Astro.url;

const isActive = (href: string): boolean => {
  if (href === '/') return pathname === '/';
  return pathname.startsWith(href);
};
---

<header class="relative z-50">
  <nav class="fixed top-0 left-0 right-0 bg-background-light/95 dark:bg-background-dark/95 backdrop-blur-md supports-[backdrop-filter]:bg-background-light/80 supports-[backdrop-filter]:dark:bg-background-dark/80 shadow-sm dark:shadow-md dark:shadow-gray-900/50 border-b border-gray-200 dark:border-border-dark">
    <div class="max-w-7xl mx-auto px-6 py-4 flex justify-between items-center">
      <a href="/" class="flex items-center group">
        <h1 class="font-display text-xl md:text-2xl font-bold bg-gradient-to-r from-primary via-accent to-primary bg-clip-text text-transparent transition-all group-hover:from-accent group-hover:via-primary group-hover:to-accent">
          The Code Sorcerer
        </h1>
      </a>
      
      <div class="hidden lg:flex items-center space-x-8">
        {navLinks.map((link) => (
          <a
            class={`${desktopLinkBase} ${isActive(link.href) ? desktopLinkActive : desktopLinkInactive}`}
            href={link.href}
            aria-current={isActive(link.href) ? 'page' : undefined}
          >
            {link.label}
          </a>
        ))}
      </div>
      
      <div class="hidden lg:flex items-center space-x-4">
        <ThemeSwitcher />
        <a class="btn-primary text-center" href="/contact">Book a Call</a>
      </div>
      
      <div class="lg:hidden flex items-center space-x-4">
        <ThemeSwitcher />
        <button class="text-gray-900 dark:text-text-dark-primary p-2 hover:bg-gray-100 dark:hover:bg-surface-dark rounded-lg transition-colors" id="mobile-menu-button" aria-label="Open menu">
          <span class="material-symbols-outlined">menu</span>
        </button>
      </div>
    </div>
    
    <!-- Mobile menu -->
    <div id="mobile-menu" class="hidden lg:hidden border-t border-gray-200 dark:border-border-dark bg-background-light dark:bg-background-dark">
      <div class="max-w-7xl mx-auto px-6 py-4 space-y-3">
        {navLinks.map((link) => (
          <a
            class={`${mobileLinkBase} ${isActive(link.href) ? mobileLinkActive : mobileLinkInactive}`}
            href={link.href}
            aria-current={isActive(link.href) ? 'page' : undefined}
          >
            {link.label}
          </a>
        ))}
        <a class="btn-primary block w-full text-center mt-4" href="/contact">Book a Call</a>
      </div>
    </div>
  </nav>
  <div class="h-[76px] md:h-[80px]"></div>
</header>

<script>
  // Mobile menu toggle
  const mobileMenuButton = document.getElementById('mobile-menu-button');
  const mobileMenu = document.getElementById('mobile-menu');
  
  mobileMenuButton?.addEventListener('click', () => {
    mobileMenu?.classList.toggle('hidden');
  });
  
  // Close mobile menu when clicking outside
  document.addEventListener('click', (e) => {
    if (!mobileMenuButton?.contains(e.target as Node) && !mobileMenu?.contains(e.target as Node)) {
      mobileMenu?.classList.add('hidden');
    }
  });
</script>
